<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1, maximum-scale=1,user-scalable=no">
  <title>Dispatcher_App</title>
  <link rel="stylesheet" href="https://js.arcgis.com/3.36/esri/css/esri.css">
  <link rel="stylesheet" href="styles/style.css">
  <script>
    var dojoConfig = {
      has: {
        "esri-featurelayer-webgl": 1
      }
    };
  </script>
  <script src="https://js.arcgis.com/3.36/"></script>
  <script>

    require([
      "dojo/dom",
      "dojo/on",
      "esri/map", 
      "esri/dijit/HomeButton",
      "esri/layers/FeatureLayer",
      "esri/arcgis/Portal",
      "esri/arcgis/OAuthInfo",
      "esri/IdentityManager",
      "dojo/dom-style",
      "dojo/dom-attr",
      "dojo/_base/array",
      "esri/dijit/Search",
      "esri/layers/StreamLayer",
      "esri/tasks/query",
      "esri/geometry/Circle",
      "esri/graphic",
      "esri/symbols/SimpleMarkerSymbol",
      "esri/symbols/SimpleLineSymbol",
      "esri/symbols/SimpleFillSymbol",
      "esri/renderers/SimpleRenderer",
      "esri/config",
      "esri/Color",
      "dojo/domReady!",
      
    ], function(dom, on,Map, HomeButton, 
                FeatureLayer,arcgisPortal,OAuthInfo,esriId , domStyle, domAttr , arrayUtils, Search)  {

      var info = new OAuthInfo({
        appId: "y62LHg9sepTcEzb0" ,//localhost
        // Uncomment the next line and update if using your own portal
        portalUrl: "https://localhost:10001/arcgis",
        // Uncomment the next line to prevent the user's signed in state from being shared
        // with other apps on the same domain with the same authNamespace value.
        //authNamespace: "portal_oauth_popup",
        popup: false
      });
      esriId.registerOAuthInfos([info]);

      //Affichage de la carte 
      var map = new Map("map", {
        center: [10, 35],  // les références de la Tunidsie
        zoom: 7,
        basemap: "topo"
      });
    

      //Création de le bouton  Home      
      var home = new HomeButton({
        map: map
      }, "HomeButton");
      home.startup();

      

      var layer = new FeatureLayer ("https://services8.arcgis.com/fM0eo5ptjcKgJViW/arcgis/rest/services/workforce_ceea173740504353aa50e5cc6a3b33b8/FeatureServer/1");
      map.addLayer(layer); 
 


      //Search bar definition  
      var search = new Search({
        map: map
      }, "search");
      search.startup();
      /*
            map.on("click", mapClickHandler);

      map.on("load", function(evtObj) {
        var map = evtObj.target;
        var incidentPointSymbol = new SimpleMarkerSymbol(
          SimpleMarkerSymbol.STYLE_CIRCLE,
          16,
          new SimpleLineSymbol(
            SimpleLineSymbol.STYLE_SOLID,
            new Color([89,95,35]), 2
          ),
          new Color([130,159,83,0.40])
        );
        incidentsGraphicsLayer = new GraphicsLayer();
        var incidentsRenderer = new SimpleRenderer(incidentPointSymbol);
        incidentsGraphicsLayer.setRenderer(incidentsRenderer);
        map.addLayer(incidentsGraphicsLayer);
      });

      function clearGraphics() {
        //clear graphics
        map.graphics.clear();
        incidentsGraphicsLayer.clear();
      }

      function mapClickHandler(evt) {
        clearGraphics();
        
        var inPoint = new Point(evt.mapPoint.x, evt.mapPoint.y, map.spatialReference);
        var location = new Graphic(inPoint);
        incidentsGraphicsLayer.add(location);
        map.graphics.enableMouseEvents();
      };
*/


     
    });

   //création du bouton locate
    require (["esri/dijit/Search"], 
      function (Search){
        var search = new Search({
        map: map
      }, "search");
      search.startup();
      }) ; 


  </script>
</head>
<body>
  <div id ="results"> 
    <button class="Start  button" type="button">
      start mission
    </button>

    <button class="Start button" type="button">
      stop mission
    </button>

  </div>
  <div id="search"></div>
  <div id="map" class="map panel" data-dojo-type="dijit/layout/ContentPane"
         data-dojo-props="region:'center'" >
    <div id="LocateButton"></div>
    <div id="HomeButton"></div>
  </div>
</body>
</html>

